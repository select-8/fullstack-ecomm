{% extends 'base.html' %}
{% load bootstrap_tags %}
{% block content %}

<div class="container">
    <div class="row">
        <div class="col-12 col-md-8 offset-md-2 text-center top-heading">
            <h2>Top Selling in Toys & Collectables</h2>
        </div>
    </div>

    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators my-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <!-- https://stackoverflow.com/questions/27219078/bootstrap-carousel-implementation-in-django -->
        <div class="carousel-inner">
            {% for product in top_toys|slice:":3" %}
            {% if forloop.counter0|divisibleby:"3" %}
            <div class="carousel-item active">
                {% else %}
                <div class="carousel-item">
                    {% endif %}
                    <div class="row row-flex justify-content-center">
                        <div class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-6 col-md-4">
                            <div class="card card-home car-card">
                                <a href="{% url 'product_detail' product.id %}" class="product"
                                    style="background-image: url('{{ MEDIA_URL }}{{ product.image }}')">
                                </a>
                                <hr>
                                <div class="container">
                                    <a href="{% url 'product_detail' product.id %}" class="product">
                                        <h3 class="product-name">{{ product.name }}</h3>
                                    </a>
                                    <p class="product-description">
                                        {{ product.description|truncatewords:10 }}<a
                                            href="{% url 'product_detail' product.id %}"
                                            class="btn btn-link more-deets">More
                                            Details</a>
                                    </p>
                                    <table class="table-borderless product-data">
                                        <td class="product-price">€{{ product.price }}</td>
                                        {% if avg_rating.rating__avg > 0 %}
                                        <td class="product-price text-center"><small>Rating:</small>
                                            {{ avg_rating.rating__avg|floatformat }}</td>
                                        {% endif %}
                                        {% if product.stock > 0 and product.cart_stock > 0 %}
                                        <td class="product-stock">In Stock</td>
                                        {% else %}
                                        <td class="product-stock">Out of Stock</td>
                                        {% endif %}
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev my-0" href="#carouselExampleIndicators" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next my-0" href="#carouselExampleIndicators" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
</div>

<hr class="home-hr">

<div class="container">
    <div class="row">
        <div class="col-12 col-md-8 offset-md-2 text-center top-heading">
            <h2>Top Selling in Comics</h2>
        </div>
    </div>

    <div id="carouselComics" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators my-indicators">
            <li data-target="#carouselComics" data-slide-to="0" class="active"></li>
            <li data-target="#carouselComics" data-slide-to="1"></li>
            <li data-target="#carouselComics" data-slide-to="2"></li>
        </ol>
        <!-- https://stackoverflow.com/questions/27219078/bootstrap-carousel-implementation-in-django -->
        <div class="carousel-inner">
            {% for product in top_comics|slice:":3" %}
            {% if forloop.counter0|divisibleby:"3" %}
            <div class="carousel-item active">
                {% else %}
                <div class="carousel-item">
                    {% endif %}
                    <div class="row row-flex justify-content-center">
                        <div class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-6 col-md-4">
                            <div class="card card-home car-card">
                                <a href="{% url 'product_detail' product.id %}" class="product"
                                    style="background-image: url('{{ MEDIA_URL }}{{ product.image }}')">
                                </a>
                                <hr>
                                <div class="container">
                                    <a href="{% url 'product_detail' product.id %}" class="product">
                                        <h3 class="product-name">{{ product.name }}</h3>
                                    </a>
                                    <p class="product-description">
                                        {{ product.description|truncatewords:10 }}<a
                                            href="{% url 'product_detail' product.id %}"
                                            class="btn btn-link more-deets">More
                                            Details</a>
                                    </p>
                                    <table class="table-borderless product-data">
                                        <td class="product-price">€{{ product.price }}</td>
                                        {% if avg_rating.rating__avg > 0 %}
                                        <td class="product-price text-center"><small>Rating:</small>
                                            {{ avg_rating.rating__avg|floatformat }}</td>
                                        {% endif %}
                                        {% if product.stock > 0 and product.cart_stock > 0 %}
                                        <td class="product-stock">In Stock</td>
                                        {% else %}
                                        <td class="product-stock">Out of Stock</td>
                                        {% endif %}
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#carouselComics" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselComics" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
</div>

<hr class="home-hr">

<div class="container">
    <div class="row">
        <div class="col-12 col-md-8 offset-md-2 text-center top-heading">
            <h2>Top Selling in Books</h2>
        </div>
    </div>

    <div id="carouselBooks" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators my-indicators">
            <li data-target="#carouselBooks" data-slide-to="0" class="active"></li>
            <li data-target="#carouselBooks" data-slide-to="1"></li>
            <li data-target="#carouselBooks" data-slide-to="2"></li>
        </ol>
        <!-- https://stackoverflow.com/questions/27219078/bootstrap-carousel-implementation-in-django -->
        <div class="carousel-inner">
            {% for product in top_books|slice:":3" %}
            {% if forloop.counter0|divisibleby:"3" %}
            <div class="carousel-item active">
                {% else %}
                <div class="carousel-item">
                    {% endif %}
                    <div class="row row-flex justify-content-center">
                        <div class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-6 col-md-4">
                            <div class="card card-home car-card">
                                <a href="{% url 'product_detail' product.id %}" class="product"
                                    style="background-image: url('{{ MEDIA_URL }}{{ product.image }}')">
                                </a>
                                <hr>
                                <div class="container">
                                    <a href="{% url 'product_detail' product.id %}" class="product">
                                        <h3 class="product-name">{{ product.name }}</h3>
                                    </a>
                                    <p class="product-description">
                                        {{ product.description|truncatewords:10 }}<a
                                            href="{% url 'product_detail' product.id %}"
                                            class="btn btn-link more-deets">More
                                            Details</a>
                                    </p>
                                    <table class="table-borderless product-data">
                                        <td class="product-price">€{{ product.price }}</td>
                                        {% if avg_rating.rating__avg > 0 %}
                                        <td class="product-price text-center"><small>Rating:</small>
                                            {{ avg_rating.rating__avg|floatformat }}</td>
                                        {% endif %}
                                        {% if product.stock > 0 and product.cart_stock > 0 %}
                                        <td class="product-stock">In Stock</td>
                                        {% else %}
                                        <td class="product-stock">Out of Stock</td>
                                        {% endif %}
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#carouselBooks" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselBooks" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
</div>
{% endblock %}